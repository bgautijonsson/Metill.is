<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rafael Daníel Vias">
<meta name="dcterms.date" content="2023-10-26">
<meta name="description" content="Hvert var hlutfall keisaraskurða af heildarfjölda fæðinga? Var fæðingartíðni breytileg á tímabilinu, var hún breytileg eftir árstíðum, og eru merki um að dagsetningar valkeisaraskurða hafi haft áhrif á fæðingartíðni eftir vikudögum, dögum ársins eða hátíðardögum?">

<title>Fæðingartíðni á Íslandi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<link href="../../favicon/favicon-32x32.png" rel="icon" type="image/png">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<meta property="og:title" content="Fæðingartíðni á Íslandi">
<meta property="og:description" content="Hvert var hlutfall keisaraskurða af heildarfjölda fæðinga? Var fæðingartíðni breytileg á tímabilinu, var hún breytileg eftir árstíðum, og eru merki um að dagsetningar valkeisaraskurða hafi haft áhrif á fæðingartíðni eftir vikudögum, dögum ársins eða hátíðardögum?">
<meta property="og:image" content="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/feature_pic.png">
<meta property="og:site_name" content="Metill">
<meta name="twitter:title" content="Fæðingartíðni á Íslandi">
<meta name="twitter:description" content="Hvert var hlutfall keisaraskurða af heildarfjölda fæðinga? Var fæðingartíðni breytileg á tímabilinu, var hún breytileg eftir árstíðum, og eru merki um að dagsetningar valkeisaraskurða hafi haft áhrif á fæðingartíðni eftir vikudögum, dögum ársins eða hátíðardögum?">
<meta name="twitter:image" content="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/feature_pic.png">
<meta name="twitter:creator" content="@bggjonsson">
<meta name="twitter:site" content="@bggjonsson">
<meta name="twitter:card" content="summary_large_image">
</head><body><nav class="navbar m-0 p-0 bg-primary">

  <div class="container bg-primary text-secondary justify-content-center flex-wrap align-items-baseline">
    <div class="d-flex flex-row">
      <header class="blog-header m-0 p-0 justify-content-center">
          <div class="col-12 d-flex">
            <a href="../../index.html" style="text-decoration: none;">
              <h1 class="navbar-brand text-secondary m-3 pb-0 mb-0">
                Metill
              </h1>
            </a>
          </div>   
      </header>
    </div>  
        <div class="col-12 d-flex justify-content-center">
          <a class="p-2 pt-0 link-secondary navbar-link text-secondary" href="../../greinar.html" style="text-decoration: none;">Greinar</a>
          <a class="p-2 pt-0 link-secondary navbar-link text-secondary" href="../../um_metil.html" style="text-decoration: none;">Um Metil</a>
        </div>
  </div>
</nav>


<link rel="stylesheet" href="../../style.css">




<div id="quarto-search-results"></div>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Fæðingartíðni á Íslandi</h1>
            <p class="subtitle lead">Tímaraðagreining á daglegum fæðingum frá 1990 til og með 2022</p>
                  <div>
        <div class="description">
          <p>Hvert var hlutfall keisaraskurða af heildarfjölda fæðinga? Var fæðingartíðni breytileg á tímabilinu, var hún breytileg eftir árstíðum, og eru merki um að dagsetningar valkeisaraskurða hafi haft áhrif á fæðingartíðni eftir vikudögum, dögum ársins eða hátíðardögum?</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">fæðingartíðni</div>
                <div class="quarto-category">valkeisaraskurðir</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author column-body">
    <div class="quarto-title-meta-heading">Höfundur</div>
    <div class="quarto-title-meta-heading">Stofnun</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://github.com/RafaelVias">Rafael Daníel Vias</a> </p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://www.hi.is/framhaldsnam/tolfraedi">
              Tölfræði, Raunvísindadeild Háskóla Íslands
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta column-body">

        
      <div>
      <div class="quarto-title-meta-heading">Síðast uppfært</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 26, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full column-body" id="quarto-document-content">





<hr>
<!-- Foreldrar geta reynt að hafaað stjórna því hvenær á árinu börn þeirra fæðast. Hafi þeir ákveðið að eignast barn geta þeir miðað níu mánuði fram í tímann og sett markið á ákveðinn hluta ársins. Í einhverjum tilfellum fá foreldrar þó einnig að velja afmælisdag barnsins.  -->
<p>Þegar keisaraskurðir eru fyrir fram ákveðnir (valkeisaraskurðir) fá foreldrar að velja fæðingardaginn í samráði við lækni. Ef hlutfall valkeisaraskurða af heildarfjölda fæðinga er nógu hátt, þá ættu áhrif slíkra ákvarðana (ef einhver) að birtast sem breytileg fæðingartíðni eftir vikudögum, dögum ársins eða fljótandi hátíðardögum (t.d. páskadagur). Sjáum við t.d. merki um það að foreldrar reyni að afstýra því að barn þeirra eigi afmæli 29. febrúar ef þeim stendur annar dagur til boða? Einnig hlýtur að teljast líklegt að valkeisaraskurðum sé stýrt frá þeim hátíðardögum sem eru samningsbundnir frídagar lækna. Hér leitumst við eftir svörum við þessum spurningum – og fleirum – með því að framkvæma tímaraðagreiningu á gögnum Hagstofunnar um daglegar fæðingar á Íslandi á árunum 1990-2022.</p>
<hr>
<section id="um-gögnin" class="level3">
<h3 class="anchored" data-anchor-id="um-gögnin">Um gögnin</h3>
<p>Notuð eru tvö gagnasett. <a href="https://github.com/RafaelVias/faedingartidni/blob/main/Data/daily_births.csv">Fyrra gagnasettið</a> sýnir daglegar fæðingar á Íslandi á árunum 1990-2022 (Hagstofa Íslands). <a href="https://github.com/RafaelVias/faedingartidni/blob/main/Data/caesarian.csv">Seinna gagnasettið</a> sýnir árlegar fæðingar á Íslandi á árunum 1970-2020 eftir gerð, þ.e. leggangafæðing eða keisaraskurður (Fæðingaskrá, kvennadeild LSH).</p>
<hr>
</section>
<section id="rýnt-í-gögnin" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="rýnt-í-gögnin">Rýnt í gögnin</h3>
<p>Valkeisaraskurðir eru greiningu okkar mikilvægir vegna þess að þeir stýra áhrifum vikudaga og daga ársins á fæðingartíðni. Tíðni leggangafæðinga á Íslandi (blár ferill) sveiflaðist til á árunum 1970-2020 en langtímahneigðin virðist halla niður á við. Aftur á móti margfaldaðist fjöldi keisaraskurða á tímabilinu (rauður ferill).</p>
<p class="page-columns page-full"><img src="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/p1.png" class="column-page img-fluid" style="width:100.0%"></p>
<p>Ef fjöldi keisaraskurða er skoðaður sem hlutfall allra fæðinga má sjá hvernig hlutfallið óx frá 1970 til 2000 og virðist svo hafa náð jafnvægi rétt ofan við efri mörk 10%-15% viðmiðs Alþjóðaheilbrigðismálastofnunarinnar (WHO). Meðaltalið á heimsvísu fyrir tímabilið 2010-2018 var um 21% <a href="https://gh.bmj.com/content/6/6/e005671">(Betran o.fl., 2021)</a>.</p>
<p class="page-columns page-full"><img src="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/p2.png" class="column-page img-fluid" style="width:100.0%"></p>
<p><a href="https://github.com/RafaelVias/faedingartidni/blob/main/Data/daily_births.csv">Gögnin</a> sem verða notuð í tímaraðagreininguna hér að neðan voru fengin frá Hagstofu Íslands með beiðni um sérvinnslu gagna og sýna fjölda daglegra fæðinga á Íslandi á árunum 1990-2022.</p>
<p class="page-columns page-full"><img src="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/p3.png" class="column-page img-fluid" style="width:100.0%"></p>
<p>Með því að reikna meðalfjölda fæðinga yfir allt tímabilið fyrir hvern dag ársins má sjá að fæðingartíðni var breytileg eftir árstíma.</p>
<p class="page-columns page-full"><img src="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/p4.png" class="column-page img-fluid" style="width:100.0%"></p>
<p>Þegar meðalfjöldi fæðinga er reiknaður eftir vikudögum sjást skýr vikudagaáhrif. Fleiri börn fæddust á virkum dögum heldur en um helgar, flestar fæðingar voru á þriðjudögum og fæstar á sunnudögum. Hér sjáum við fyrstu ummerki þeirra áhrifa sem val á dagsetningum valkeisaraskurða hafði á fæðingartíðni.</p>
<p class="page-columns page-full"><img src="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/p5.png" class="column-page img-fluid" style="width:100.0%"></p>
<p>Ef meðaltölin eru reiknuð fyrir þrjú aðskilin tímabil má sjá að í seinni tíð hefur valkeisaraskurðum verið stýrt í auknum mæli frá mánudögum og miðvikudögum yfir á þriðjudaga og fimmtudaga.</p>
<p class="page-columns page-full"><img src="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/p6.png" class="column-page img-fluid" style="width:100.0%"></p>
<hr>
</section>
<section id="tölfræðilíkan" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="tölfræðilíkan">Tölfræðilíkan</h3>
<p>Til þess að meta áhrif tiltekinna daga ársins á fæðingartíðni þurfum við að einangra langtíma-, árstíðar-, og vikudagaáhrifin. Við búum því til tölfræðilíkan sem metur væntigildi fjölda fæðinga yfir tímabilið sem summu þessara fjögurra þátta. Tölfræðilíkanið er byggt á líkani <a href="https://github.com/avehtari/casestudies/tree/master/Birthdays">Gelman, Vehtari, Simpson o.fl. (2022)</a> sem búið var til fyrir sambærileg gögn frá Bandaríkjunum. Myndin hér að neðan sýnir niðurstöður tölfræðilíkansins sem mátað er að íslensku fæðingargögnunum. Gögnin hafa verið sköluð þannig að lóðrétti ásinn sýnir hlutfallsleg frávik frá meðalfjölda fæðinga yfir allt tímabilið (~12).</p>
<p class="page-columns page-full"><img src="https://raw.githubusercontent.com/RafaelVias/faedingartidni/main/Figures/p12.png" class="column-page img-fluid" style="width:100.0%"></p>
<p>Á myndinni efst til vinstri má sjá gögnin (bláir punktar) og væntigildi líkansins (rauður ferill). Væntigildið er summa fjögurra þátta: langtímahneigðar (f1), árstíðaráhrifa (f2), vikudagaáhrifa (f3) og áhrifa daga ársins sem og fljótandi hátíðardaga (f4). Fljótandi hátíðardagar eru þeir hátíðardagar sem lenda ekki á sama degi ársins ár hvert (t.d. páskadagur). Þannig táknar 10% að fæðingartíðnin var 10% yfir heildarmeðaltalinu, eða um 13 fæðingar. Hins vegar táknar -15% að fæðingartíðnin var 15% undir heildarmeðaltalinu, eða um 10 fæðingar.</p>
<p>Myndin efst hægra megin sýnir hvernig langtímahneigðin (rauður ferill) breytist yfir tímabilið. Ferillinn fer úr hámarkinu í upphafi tímabilsins niður í lágmarkið stuttu eftir aldamótin. Hann rís svo aftur og nær staðbundnu hámarki stuttu eftir bankahrun, um 2010. Því næst lækkar ferillinn aftur þar til stuttu fyrir heimsfaraldurinn 2020 þegar hann tekur að rísa en fellur svo aftur 2022.</p>
<p>Vinstri myndin í línu tvö sýnir árstíðaráhrifin (rauður ferill). Þar sést að flestar fæðingar voru að staðaldri í lok september, níu mánuðum eftir jólahátíðina. Árstíðarhneigðin fellur svo frá hámarkinu niður í lágmarkið um jólahátíðina og tekur svo aftur að rísa.</p>
<p>Vikudagaáhrifin eru sýnd á hægri myndinni í línu tvö. Áhrifin eru reiknuð fyrir sjö aðskilin tímabil og sjá má að valkeisaraskurðir ollu því að fæðingartíðni var mismunandi eftir vikudögum. Einnig má sjá hvernig vikudagaáhrifin breyttust yfir tímabilið. Til að mynda virðast valkeisaraskurðir í sífellt ríkara mæli hafa verið framkvæmdir á þriðju- og fimmtudögum frá og með árunum 2010-2014.</p>
<p>Að lokum sýnir neðsta myndin áhrif daga ársins og fljótandi hátíðardaga á fæðingartíðni. Engin áhrif voru metin fyrir 29. dag febrúarmánaðar en flestir hátíðardagar höfðu neikvæð áhrif á fæðingartíðni. Flestum valkeisaraskurðum virðist hafa verið stýrt frá hátíðardögunum yfir jólin.</p>
<hr>
</section>
<section id="niðurlag" class="level3">
<h3 class="anchored" data-anchor-id="niðurlag">Niðurlag</h3>
<p>Fjöldi fæðinga á Íslandi hefur farið fækkandi frá árinu 1970 á sama tíma og fjöldi keisaraskurða hefur margfaldast. Hlutfall keisaraskurða af heildarfjölda fæðinga á Íslandi var um 16% á árunum 1990-2022. Gögnin sýna að fæðingar voru tíðari á virkum dögum heldur en um helgar og að valkeisaraskurðum hafi í seinni tíð verið stýrt í auknum mæli frá mánudögum og miðvikudögum yfir á þriðjudaga og fimmtudaga. Árstíðaráhrifin ná hámarki í lok september og falla svo niður í lágmarkið um jólahátíðina. Þá benda niðurstöður tölfræðilíkansins til þess að valkeisaraskurðum hafi verið stýrt frá mörgum af helstu hátíðardögum Íslendinga. Mest voru neikvæð áhrif hátíðardaganna yfir jólin. Líkanið metur engin áhrif 29. dag febrúarmánaðar.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/metill\.is");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../um_metil.html">
<p>Um Metil</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>